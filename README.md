# CalcPro — бот для анализа ОСВ iiko

Этот проект представляет собой телеграм-бота, который помогает анализировать оборотно-сальдовую ведомость (ОСВ) из системы iiko. Бот принимает Excel‑файл, вычисляет допустимые отклонения по излишкам и недостачам и возвращает таблицу с подсветкой проблемных строк.

## Возможности
- Проверка подписки пользователя на указанный канал.
- Приём Excel‑файла, созданного в формате `Расширенная оборотно-сальдовая ведомость ДД.ММ.ГГГГ ЧЧ.ММ.СС.xlsx`.
- Расчёт отклонений с учётом заданного или стандартного порога (по умолчанию 3.5%).
- Возврат обработанного файла с цветовой подсветкой.

## Установка
1. Склонируйте репозиторий и перейдите в каталог проекта:
   ```bash
   git clone <URL-репозитория>
   cd iiko
   ```
2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```

## Настройка
Создайте файл `.env` в корне проекта со следующими переменными:
```env
BOT_TOKEN=токен_вашего_бота
CHANNEL_USERNAME=@username_канала
```

## Запуск
Запустите бота командой:
```bash
python bot.py
```

## Использование
1. Подписывайтесь на канал, указанный в `CHANNEL_USERNAME`.
2. Отправьте боту файл ОСВ в формате `.xlsx` с корректным именем.
3. Укажите допустимый процент отклонения без знака `%` или отправьте `Нет` для значения по умолчанию.
4. Получите обработанный файл с подсветкой строк, где обнаружены отклонения.

## Структура проекта
- `bot.py` — обработка команд и взаимодействие с пользователем.
- `fileHandler.py` — логика обработки и анализа Excel‑файла.
- `requirements.txt` — список зависимостей проекта.
